## 来自虾皮面经

#### 什么是CSRF和XSS攻击？

CSRF(Cross-site request forgery)跨站请求伪造：攻击者诱导受害者进入第三方网站，在第三方网站中，向被攻击网站发送跨站请求。利用受害者在被攻击网站已经获取的注册凭证，绕过后台的用户验证，达到冒充用户对被攻击的网站执行某项操作的目的。

CSRF攻击不需要将恶意代码注入用户的页面，仅仅是利用服务器的漏洞和用户的登录状态来实施攻击。用户在访问钓鱼网站时会无意触发请求（如银行转账等，若银行转账系统只需要携带cookie就可以发起转账请求）。

**防护策略**：
- 同源检测：同源需要协议、域名、端口三者全匹配，若B网站希望访问A网站的服务接口，而A设置了禁止外域的请求，这样就可以成功防范CSRF攻击。
- 双重Cookie认证：CSRF无法获取用户Cookie，因此可以在前端像后端发起请求的过程中，后端验证本身携带的Cookie和header或请求体中的cookie是否都符合要求。
- 后端接口防范：严格管理所有上传接口，添加Header(X-Content-Type-Options:nosniff)防止黑客上传HTML内容资源，或对用户上传的图片进行转存和校验

------

XSS（Cross Site Script）跨站脚本攻击是攻击者把恶意 JavaScript 代码（或其他脚本）伪装成 “正常内容”，通过用户输入（如评论、表单）提交给网站；网站未过滤就把这段代码存到服务器，再返回给其他用户的浏览器；浏览器误以为是 “合法网页代码”，自动执行恶意脚本，最终窃取用户信息（如 Cookie、账号）或操控用户行为（如冒充发消息）。

XSS攻击的3种常见场景有：
1. 存储型XSS：攻击者在博客评论区发<script>偷Cookie代码</script>，网站存到数据库；其他用户点开评论页，代码被执行
2. 反射性XSS：的用户）攻击者构造链接 http://网站.com/search?key=<script>弹窗代码</script>；用户点链接后，网站把 URL 里的恶意代码拼进页面执行
3. DOM 型 XSS：网站前端有 document.write(location.href)；攻击者构造链接带恶意代码，前端 JS 直接把代码写到页面执行

**防护策略**
- 输入输出转义：讲危险字符换成安全的文本符号如&lt
- 加安全头限制脚本执行：给cookie加属性，禁止前端js读取Cookie或仅允许HTTPS协议传输cookie
