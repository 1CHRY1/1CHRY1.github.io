## 数据库相关

#### <font color=darkblue>1. 存储&数据库系统</font>

##### 1.1 存储系统

`存储系统`: 提供读写，控制类接口，能安全有效地讲数据持久化的软件
存储系统与用户，介质，内存，网络均相关联，具有**性能敏感**，**代码易使用又不易损坏**，**容易受硬件影响**该些特点。

`存储器（硬件）`：power与term成反比

`存储器（软件）`：**缓存**易于跨软硬件层间交互；**拷贝**消耗cpu，尽可能减少；硬件五花八门，需要**抽象统一的接入层**

`RAID技术`：高性能，高性价比，高可靠性 —— RAID1，RAID0，RAID1+0

##### 1.2 数据库系统

`关系型数据库`：就是存储系统，但在其基础之上有其他能力。相比于传统存储系统——用表形式更易于存储和查询；支持事务的优越性ACID；能通过SQL进行复杂查询。

`非关系型数据库`：同关系型数据库，但半结构化数据友好，可能支持事务，可能支持复杂查询语言。

#### <font color=darkblue>2. 主流产品剖析</font>

##### 2.1 单机存储

`本地文件系统`：
linux文件系统都遵循`VFS`统一抽象接口；
linux文件系统两大数据结构——index Node（记录文件元数据，唯一标识）；Directory Entry（记录文件名指针层级关系等，与inode为N比1的关系）

`key-value存储`：
常见数据结构：LSM-Tree（某种程度牺牲了读性能，追求写性能）
产品：RocksDB

##### 2.2 分布式存储

`分布式存储`：单机存储的基础上实现分布式协议，涉及大量网络交互
产品：HDFS, Ceph

`分布式文件存储系统`：海量数据存储，高容错，高吞吐，存量大

`分布式对象存储系统`：

##### 2.3 单机关系型数据库

产品：Oracle，MySQL，PostgreSQL

通用组件：
Query Engine（解析SQL，生成查询计划）；
Txn Manager（事务并发管理）；
Lock Engine（锁相关策略）
Storage Engine（组织内存与读写）；
Replication（负责主备同步）；

关键数据结构：
B-Tree, B+Tree,LRU List

关键磁盘数据结构：
WriteAheadLog（RedoLog），Page

##### 2.4 单机非关系型数据库

产品：MongoDB，Redis，Elasticsearch（可以使用模糊搜索）

##### 2.5 单机到分布式数据库

问题：`容量`，`弹性`，`性价比`
解决方案：存储节点池化，动态扩缩容

#### <font color=darkblue>3. 新存储与数据库技术</font>

##### 3.1 软件架构变更

SPDK：避免systemcall性能损耗，直接从用户态访问磁盘；绑定cpu核不断轮询减少中断；使用无锁数据结构，降低并发操作的同步开销。

##### 3.2 AI增强

数据存储格式的改进，行存/列存的AI决策

##### 3.3 新硬件革命

RDMA网络：相当于绕过传统网络协议栈，将用户太虚拟内存映射给网卡，减少拷贝核cpu开销。

Persistent Memory

可编程交换机：在交换机层对网络包做计算逻辑。数据库场景下，可以实现缓存的一致性协议等。

CPU/GPU/DPU：多核

